[[!comment format=mdwn
 ip="127.0.0.1"
 subject="comment 16"
 date="2013-05-10T22:29:42Z"
 content="""
Why are so many NGOs and security researchers are confident that Gamma malware is being actively used by numerous repressive governments (such as Vietnam, Bahrain, Morocco) to target opposition party leaders, political dissidents, reporters, and bloggers?

Here is a brief resume of some of the published evidence, with some further information about how known Gamma malware operates.

In June 2010, before the recent revolution in Egypt, Gamma Group met with representatives of the now defunct Mubarak regime to broker a purchase of Gamma dragnet-surveillance-as-a-service \"product\".  The meeting resulted in a document in Arabic which contained an offer by Gamma to the Egyptian government.  This listed as Gamma's contact person one \"Johnny Debs\".  The asking price for one FinSpy proxy license, 25 FinSpy client licenses, installation and training, and one year of tech support was given as 0.287 million Euros.

In April 2011, just after the Mubarak regime was toppled, Egyptian pro-democracy activist Mostofa Hossem and hundreds of other citizens entered the abandoned headquarters of the secret police, looking for his own intelligence dossier.  He found it, and more importantly, he found the government copy of the tender from Gamma, which was then published by Wikileaks.  Other reporters published extensive evidence that a dragnet surveillance systems bought from Amesys, the French IT giant, had been in active use by the Mubarak regime, as well as grisly documentation of the torture of people arrested after being \"outed\" by the Western made spygear.

In August 2012, several Bahraini pro-democracy activists, who use Windows, received phishing emails.  The emails were sent from a gmail.com account suggesting they had been sent by an Al Jazeera reporter, and contained attachments which were allegedly images and Word documents.  Suspicious, they gave the emails to Vernon Silver, a reporter for Bloomberg News, who passed them on to security experts at Rapid7, Google, and other firms.

Quickly thereafter, Rapid7 published an analysis of samples of Finfisher found in test machines infected with the malicious attachments.  The investigator found that the malware loader exploited the Right to Left Override character to disguise the fact that the attachments contained Windows executables.  The infection used process hollowing (legitimate processes are spawned, but the contents of the legitimate programs loaded in RAM are then overwritten with malware code, which is then executed).

Curiously, it was found that when the infected test machines contacted C&C servers, these responded with the string \"Hallo, Steffi\".  Immediately after this feature was published, these servers altered their behavior.

From July 2012 to the present, Citizen Lab, which is affiliated with the University of Toronto, has published several detailed studies of certain Gamma malware, all authored or coauthored by Morgan Marquis-Boire, a Google expert on reverse engineering malware.  You can find the original reports at

      http://www.citizenlab.org

Here is my attempted executive summary of their findings:

* \"From Bahrain with Love: FinFisher's Spy Kit Exposed?\", July 2012.  

Analyzes the same samples studied by Rapid7.  The Google/Citizen Lab investigator found unambiguous traces identifying the trojan as FinSpy v.4.01.  The test machines infected with samples from Bahrain later contacted C&C servers at IP addresses registered to the national telecom in Bahrain, and also a Gamma International server at an IP registered to Martin Muench himself.

* \"The SmartPhone Who Loved Me: FinFisher Goes Mobile?\", August 2012. 

Analyzes FinSpy-Mobile sample found in Android, Nokia Symbian, Blackberry, and Windows Mobile smart phones used by activists in various countries.  Citizen Lab allowed the loaders to infect test machines and found unambiguous traces showing that the trojan was FinSpy-Mobile.  

These traces included a \"developer certificate\" which was issued by Apple Root CA (which is trusted by Apple manufactured smart phones) to none other than Martin Muench.  This certificate was apparently used to fool the phone into treating Gamma malware as a legitimate upgrade.  Some evidence suggested a similar procedure had been used to obtain authentication keys which would fool Blackberry devices into treating Gamma malware as legitimate update.

Over time Citizen Lab observed their infected test machines connecting to a number of C&C servers.  One was registered to a \"Johnny Debs\", who supposedly works for an obscure Lebanese company.  The researchers discovered that a Johnny Debs has represented Gamma International at trade shows.  Another C&C server was registered to Gamma itself in Munich.  

The researchers found that some data was stored in Base-64 encoded files.  Others were stored in files which were partially encrypted with a hideously crippled form of AES (256 bit keys, CBC mode, no padding), in which the keys were very simple and predictable (almost certainly generated by the malware using some simple scheme).  Only the first portion of these data files were encrypted, suggesting that AES was being used to provide some crude form of authentication to the C&C server.

Another test machine, infected with a sample from a Malaysian activist, was discovered to use the infected phone to call up a phone number in Malaysia.  The analysis also showed the trojan sending (poorly and incompletely encrypted) data via http to C&C servers on ports 21,22,53,80,433,3111,4111,9111, with evidence suggesting that 4111 is the actual default FinSpy C&C server port.  One of the C&C servers was on Amazon EC2 (Elastic Compute cloud).

* \"You Only Click Twice: FinFisher's Global Proliferation\", March 2013. 

Reports on continuing research with further samples of Gamma malware which revealed Gamma C&C servers in 25 countries: Australia, Bahrain, Bangladesh, Brunei, Canada, Czech Republic, Estonia, Ethiopia, Germany, India, Indonesia, Japan, Latvia, Malaysia, Mexico, Mongolia, Netherlands, Qatar, Serbia, Singapore, Turkmenistan, United Arab Emirates, United Kingdom, United States, Vietnam.  

A Ethiopian pro-democracy activist received a phishing email containing a suspicious attachment (photos of members of Ginbot7, an Ethiopian pro-democracy group).  Suspicious, he gave these to a reporter, who passed them on to Citizen Lab, which used them to infect a test machine with what turned out to be FinSpy-Mobile; the infected machine later called home to a C&C server at an IP registered to Ethio Telecom.

A Vietnamese pro-democracy activist provided another sample.  When Citizen Lab allowed it to infect a test machine, the trojan, which again turned out to be FinSpy-Mobile, later tried to call up a phone number registered to CMC Telecom in Hanoi.

Only day after Rapid7 published snort signatures detecting FinSpy infections, CitizenLab noticed C&C servers updating the Gamma trojans installed on its test machines.  The updates allowed the trojan to evade the published snort signatures.  Months after activists started using new, unpublished signatures, the trojans were again updated to evade these.

Spiderlabs also analyzed the behavior of a test machine infected with a sample of FinSpy-Mobile which had targeted an activist using an Android smart phone.  The investigator found that the malware stored data in the *attributes* of certain generally innocuous files.

When challenged by reporters, Martin J Muench has consistently denied selling Gamma malware to oppressive regimes, and he has offered various explanations for the growing evidence that his \"products\" have been extensively used by the most brutal regimes on the planet to target legitimate political opposition parties and bloggers, resulting in arrest, torture, imprisonment, and in some cases, in death.  According to news reports, at various times he has claimed that:

* miscreants managed to weaponize a harmless \"demo version\" of Gamma malware
* miscreants obtained genuine Gamma malware by hacking a Gamma server
* yes, Gamma exploited an unpublished Apples iTunes flaw to infect victims with malware, but Apple should be blamed for not protecting its users better

In October 2011, the Chaos Computer Club, the Berlin tech collective which operates numerous high-bandwidth Tor exit servers, published a detailed study of a test computer infected resulting from a suspicious attachment they were given by a lawyer.  They discovered that the trojan was made by an obscure German company

      Digitask GmbH
      Hüttenstraße 48 35708
      Haiger
      GERMANY 
      Tel: +49 2773 - 74788-0
      Fax: +49 2773 - 74788-60
      www.digitask.de

Its unofficial nickname inside the Bavarian State police agency turned out to be Ozapftis, but it has become better known as the Bundestrojaner (\"Federal trojan\"), or Staatstrojaner (\"Government trojan\").  It is known inside DigiTask as \"LI System\", where it is euphemistically characterized as Fernforensische (\"remote forensics\") software.  It has also been dubbed Win32/R2D2 by anti-malware companies.

After angry questions from German legislators, several State police agencies admitted that they were using this malware against German citizens (and others), in many cases apparently without a warrant.  The disclosure resulted in considerable public outrage and a great deal of bad press, and the public was left with the impression that German police agencies are now banned from using malware.  But in December 2012, both federal and state police agencies quietly announced that they plan to purchase and use Gamma malware.

In October 2012, the Dutch government proposed to use malware to hack into computers whose location is unknown.  The Tor Project then revealed that Dutch police had been using malware (without legal authority) to target servers running hidden services.  This caused considerable fuss in the Dutch press.  If, as seems fairly probable, the Dutch state-sponsored attackers used Gamma malware, it is noteworthy that (again according to the Tor Project), their intrusions failed to gather any evidence usable in Dutch courts.

In December 2012, the UK began for the first time to limit the exports of malware by Gamma Group.  Currently, Privacy International and other groups are pressuring the UK authorities to investigate further how rogue states have managed to obtain and use Gamma malware.

The case continues.

"""]]
