[[!comment format=mdwn
 ip="127.0.0.1"
 subject="comment 14"
 date="2012-11-15T04:26:47Z"
 content="""
This excellent thread should be looked upon by the Tor and Tails developers. Has Mozilla dropped the ball on this? It appears to me to be a vicious bug which should be patched.

##>Firefox, Opera allow crooks to hide an entire phish site in a link

>http://www.theregister.co.uk/2012/09/03/phishing_without_hosts_peril/

>Firefox, Opera allow crooks to hide an entire phish site in a link

>Watch out for the tinyurl that isn't | By John Leyden | Security, 11/3/2012

>A shortcoming in browsers including Firefox and Opera allows crooks to easily hide an entire malicious web page in a clickable link - ideal for fooling victims into handing over passwords and other sensitive info.

>Usually, so-called \"phishing attacks\" rely on tricking marks into visiting websites designed by criminals to masquerade as banks and online stores, thus snaffling punters' credentials and bank account details when they try to use the bogus pages. However this requires finding somewhere to host the counterfeit sites, which are often quickly taken down by hosting companies and the authorities or blocked by filters.

>Instead, the malicious web pages can be stored in data URIs - uniform resource identifiers, not to be confused with URLs - which stuff the web code into a handy string that when clicked on, instructs the browser to unpack the payload and present it as a page.

>It negates the need to find somewhere to secrete your malicious page, and once shortened using a service such as TinyURL, the URI can be reduced to a small URL perfect for passing around social networks, online chats and email. Crooks may need to set up a server to receive data from victims, however.

>It's a technique already documented by researchers Billy Rios and Nathan McFeters - but now Henning Klevjer, an information security student at the University of Oslo in Norway, has revisited the attack method in his paper, Phishing by data URI [PDF].

>Typically an attacker would first create a standalone web page, probably using content scraped off the legitimate site it seeks to mimic before making an encoded page and embedding it into a data URI.

>URI-based attacks were previously documented by Rios and McFeters as part of an attack Microsoft’s Internet Explorer 6 and 7. Klevjer's research expands on this basic theme and gives it a modern twist.

>Google’s Chrome browser blocks redirection to data URIs, and other browsers have limits on the volume of data that can be packed into URIs. Klevjer created a 26KB attack page that failed to load in Internet Explorer, but worked on both Firefox and Opera.

>As well as getting around the need to find a home for malicious web pages, the data URI trick can sidestep traditional scam defences, such as web filtering. Data URIs may also contain a potentially malicious Java applet, a major concern following last week's Java-related security flap, a post on Sophos's Naked Security blog notes. ®

Thank you for the bug report pages, this one appears to have a lot of insight:

https://bugzilla.mozilla.org/show_bug.cgi?id=786275
"""]]
