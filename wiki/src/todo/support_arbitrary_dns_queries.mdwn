[[!toc levels=2]]

Rationale
=========

The Tor DNS resolver Tails is currently using lacks support for most
types of DNS queries except "A". A better user experience would be
provided if Tails was able to resolve any kind of DNS queries out of
the box.

Implementation
==============

Inserting ttdnsd into the DNS resolver loop is the obvious solution.
ttdnsd listens for UDP DNS requests and forwards these via the Tor
SOCKS proxy to an open recursive DNS resolver on the Internet.

But we cannot just replace pdnsd with ttdnsd as the latter, unlike the
former, does no caching at all. The DNS resolution process could then
be:

    resolv.conf -> DNS forwarding+caching proxy -> ttdnsd -> Tor

Forwarding+caching DNS proxy candidates:

- pdnsd: already installed on Tails
- dnsmasq: very flexible DNS forwarder
- unbound: recursive-only caching DNS server which can perform DNSSEC
  validation of results; the DNSSEC feature is appealing, but the
  recursive-only nature of unbound probably makes it impossible to
  plug into the proposed DNS resolutions process

=> keeping our known-working pdnsd configuration seems to be the safe
choice.

[[!tag todo/code]]
