We need to start porting Tails to Wheezy, and test it.

Work is done in the `feature/wheezy` Git branch.

**Current state** (2013-06-30): builds, boots. Quite some things are
broken, and many minor features had to be disabled to workaround
build issues.

[[!toc levels=2]]

Problems to fix
===============

[[!tag todo/code]]

* [[Fix tails-greeter|todo/tails-greeter_vs._Wheezy]]
* There is no firewall. `ferm` fails to restore rules.
* Fix `/etc/init.d/tails-kexec`: `/etc/default/locale` does not exist.
* `amnesia` users sudoers credentials to localize console at profile
  time don't work
* `/usr/local/sbin/udev-watchdog` not found
* `scim-anthy`, `scim-pinyin`, `scim-uim` and `scim-hangul` must be replaced by the Wheezy equivalent
* Get `config/chroot_local-hooks/50-virtualbox` back (revert 592d364)
  and fix it.
* Persistence for NM connections is broken. See [corresponding issue in
  LibertÃ©](https://github.com/mkdesu/liberte/issues/4)
  - Is it really, even after most of the secrets handling was moved
    back to GNOME keyring, and the Wi-Fi connections back to be
    considered as "user" ones unless user is allowed to configure
    system ones (since [[!debpkg network-manager-gnome]] 0.9.4.1-3)?
    Perhaps tweaking the policykit settings so that the `amnesia` user
    is not allowed to configure connections would be enough to
    workaround this?
* Use GNOME fallback mode (but ship GNOME shell too if it's not too
  big -- that will be unsupported, but advanced users might want to
  find their own ways to use it)
* Find and install I2P packages compatible with Wheezy, then revert
  1b9ae07 and 16d9aef.
* Fix the build for real (workaround'd in 4218f2e4): at `lb source`
  time, when `lb chroot_sources install` wants to run `apt-get
  upgrade`, it fails the build with `The value 'wheezy' is invalid for
  APT::Default-Release as such a release is not available in the
  sources` (due to the APT proxy not being configured at this time,
  the last `apt-get update` failed and the package indices are empty).
  If one simply removes `APT::Default-Release`, then the pinning is
  broken when indices are not available. Actually, if `lb source` just
  exited early unless `LB_SOURCE` is enabled, we would not have
  this problem.
* Re-enable Indymedia IRC account (disabled by
  `bugfix/disable-indymedia-irc-account`) and convert it to use the
  hidden service and SASL.
* Upload aircrack-ng to wheezy-backports and install from there (see
  70068b4).
* Restore tails-about patch functionality (this desktop file does not
  exist on Wheezy, see commit 65a776d).
* List newly installed packages, remove those we don't want.
* Don't show the "GNOME 3 Failed to Load" notification.
* Replace "Debian Live user" fullname with something else?
  It's now displayed in the top GNOME panel.
* Use a less aggressive Florence theme? Seems like none is shipped by
  default, so perhaps we don't want to spend too much time on this.
* Add a fast shutdown button back. That probably means adapting our
  applet to work with GNOME Panel 3.4.
* Add `feature/wheezy` to the set of branches built by Jenkins.
* [[todo/update_default_partitions_size]]
* disable system sounds
* run spice-vdagent in the greeter session
* fix background picture to be more innocuous
* don't automount external storage devices
* much too small fonts in the USB installer
* don't ship GNOME Shell, else it's auto-selected on hardware that
  supports it (and eats space uselessly)
* Wheezy's *Authentication is required to update packages* shell
  prompt bug is still here. On it's way to be solved in
  a point-release, IIRC.
* Pidgin crashes. When run without torsocks, and works fine when
  the proxy settings are manually pointed to Tor.
* remove most of these:

    baobab caribou caribou-antler empathy empathy-common fonts-cantarell
    gnome-backgrounds gnome-dictionary gnome-font-viewer gnome-icon-theme-extras
    gnome-packagekit gnome-packagekit-data gucharmap libcaribou-gtk-module
    libcaribou-gtk3-module libchamplain-0.12-0 libchamplain-gtk-0.12-0
    libgdict-1.0-6 libgdict-common libgeocode-glib0 libgucharmap-2-90-7
    libtelepathy-farstream2 sound-theme-freedesktop telepathy-logger vino

* remove dconf-editor
* remove *Software Update* (at least the launcher)
* Liferea seems to not connect
* emergency shutdown on USB does not trigger anything
* starting Tails doc => Yelp says "Document not found"
* remove NetworkManager VPN helper

Tests to do
===========

[[!tag todo/test]]

* is [[bugs/plymouth_stops_too_early]] fixed on Wheezy?
* is [[bugs/desktop_crashes_with_claws-mail_and_gpg-agent]]
  fixed on Wheezy?
* does `liveusb-creator` work fine *without* our patched
  `dbus-python` package?
* replace laptop-mode-tools with acpi-support + pm-utils + hdparm
  (that ships `/usr/lib/pm-utils/power.d/95hdparm-apm`);
  does this combination take care of Wi-Fi power management?

Research to do
==============

[[!tag todo/research]]

Windows Camouflage
------------------

How to implement the Windows Camouflage mode in GNOME3 "Classic" (aka.
fallback) mode?

* Ubuntu's GNOME Classic is not that far from a good old GNOME2 DE:
  https://help.ubuntu.com/community/PreciseGnomeClassicTweaks
* The default theme (`/usr/share/themes/Adwaita/gtk-3.0/`) can be
  forked and customized.
* GTK3 Windows-like themes seem to be
  [in the works](http://blogs.gnome.org/alexl/2012/03/27/moar-windows-themes/),
  and <http://gnome-look.org/> has a few ones.
* some [customization tips](http://askubuntu.com/questions/69576/how-to-customize-the-gnome-classic-panel)

What works
==========

* Reading (IMAP) and sending email with Claws.
* OpenPGP applet symmetric enc/dec
* Roundcube webmail
* MAT cleans a PDF
